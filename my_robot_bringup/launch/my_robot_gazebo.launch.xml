<launch>
    <!--gonna find share folder, in my_robot_description-->
    <let name="urdf_path"
        value="$(find-pkg-share my_robot_description)/urdf/my_robot.urdf.xacro" />
    <let name="rviz_config_path"
        value="$(find-pkg-share my_robot_bringup)/rviz/urdf_config.rviz" />

    <!--start robot state publisher-->
    <node pkg="robot_state_publisher" exec="robot_state_publisher" output="screen">
        <param name="robot_description"
              value="$(command 'xacro $(var urdf_path)')" />
    </node>

    <include file="$(find-pkg-share gazebo_ros)/launch/gazebo.launch.py">
        <arg name="world" value="$(find-pkg-share my_robot_bringup)/worlds/test_world.world" />
    </include>

    <!--spawn robot-->
    <node pkg="gazebo_ros" exec="spawn_entity.py"
         args="-topic robot_description -entity my_robot" />
         
    <!--start rviz2-->
    <node pkg="rviz2" exec="rviz2" output="screen" 
        args="-d $(var rviz_config_path)"/>
        <!-- -d config file flag for RViz-->

    <node pkg="joy" exec="joy_node" output="screen">
        <param name="device_id" value="0"/>
        <param name="deadzone" value="0.05"/>
        <param name="autorepeat_rate" value="20.0"/>
    </node>

    <node pkg="teleop_twist_joy" exec="teleop_node" output="screen">    <!--xbox gamepad configurations-->
        <param name="axis_linear.x" value="1" />
        <param name="scale_linear.x" value="0.5" />
        <param name="scale_linear_turbo.x" value="1.0" />
        
        <param name="axis_angular.yaw" value="0" />
        <param name="scale_angular.yaw" value="0.5" />
        <param name="scale_angular_turbo.yaw" value="1.0" />
        
        <param name="enable_button" value="5" />                        <!--Hold 'RB' while driving-->
        <param name="enable_turbo_button" value="7" />                  <!--Hold 'start' while driving in turbo mode-->
        <param name="require_enable_button" value="true" />
    </node>    
</launch>